# HomeLabs â€” Day 4 Log

**Date:** 2026-01-11
**Primary Server:** Lenovo ThinkPad E530c
**Primary Client:** Acer Predator (Arch Linux)
**Networks Tested:**

* Home Router (No Internet): `192.168.1.0/24`
* Mobile Hotspot: `10.70.133.0/24`

---

## Objectives for Day 4

* Enable **multi-network access** to the server
* Configure **Samba (SMB)** for cross-platform clients
* Configure **NFS** for Linux-native clients
* Ensure access works **with and without internet**
* Stabilize hostname resolution across networks
* Validate firewall rules for both subnets
* Confirm persistence via automounts
* Ensure client-side repeatability

---

## Server-Side Configuration (ThinkPad)

### 1. Network State

* Server successfully operated on **two different subnets**
* IPs observed:

  * `192.168.1.4` (Home router)
  * `10.70.133.216` (Mobile hotspot)
* Hostname standardized as:

  ```
  thinkpad
  ```

---

### 2. SSH (Baseline Access)

* OpenSSH server active and enabled
* Verified access from Predator using:

  ```bash
  ssh arjun@thinkpad
  ```
* SSH works on both networks

---

### 3. Storage Layout (Confirmed)

```text
/dev/sda  -> OS (128 GB SSD)
/
â””â”€â”€ Linux Mint

/dev/sdb1 -> Data Disk (465 GB HDD)
â””â”€â”€ /srv/data
```

* Mounted persistently via `/etc/fstab`
* Filesystem: `ext4`
* SMART health: **PASSED**

---

### 4. Samba (SMB) Configuration

**Purpose:**
Universal access for Android, Windows, TVs, iOS, and Linux clients.

**Share Created:**

```ini
[Family]
path = /srv/data/family
browseable = yes
read only = no
valid users = arjun
create mask = 0664
directory mask = 0775
```

**User Setup:**

```bash
sudo smbpasswd -a arjun
sudo smbpasswd -e arjun
```

**Validation:**

```bash
smbclient -L //thinkpad -U arjun
```

**Result:**

* Share `Family` visible and accessible
* SMB works across subnets using IP or hostname

---

### 5. NFS Configuration (Linux Clients)

**Purpose:**
High-performance, permission-preserving Linux mounts.

**Exports (`/etc/exports`):**

```text
/srv/data 10.70.133.0/24(rw,sync,no_subtree_check,no_root_squash)
/srv/data 192.168.1.0/24(rw,sync,no_subtree_check,no_root_squash)
```

**Applied with:**

```bash
sudo exportfs -ra
sudo systemctl restart nfs-server
```

**Result:**

* NFS accessible on both networks
* Works without DNS, internet, or mDNS

---

### 6. Firewall (UFW)

Allowed services and subnets:

```bash
sudo ufw allow ssh
sudo ufw allow samba
sudo ufw allow from 10.70.133.0/24
sudo ufw allow from 192.168.1.0/24
sudo ufw reload
```

* Firewall confirmed non-blocking for SMB/NFS/SSH
* IPv4 + IPv6 rules handled

---

### 7. Hostname Resolution Strategy

**Problem encountered:**

* `avahi-daemon` conflicted with Docker bridge (`172.17.0.1`)
* `.local` resolution unreliable across multiple interfaces

**Solution (Intentional & Stable):**

* Disabled dependency on mDNS
* Used static mapping on clients

**Client `/etc/hosts`:**

```text
192.168.1.4     thinkpad
10.70.133.216   thinkpad
```

**Result:**

* Deterministic resolution
* Works offline
* No multicast dependency

---

## Client-Side Configuration (Predator / Arch Linux)

### 1. Required Packages

```bash
sudo pacman -S openssh nfs-utils cifs-utils smbclient
```

---

### 2. NFS Client Mount

**Mount Point:**

```bash
sudo mkdir -p /mnt/homelab
```

**fstab entry:**

```text
thinkpad:/srv/data  /mnt/homelab  nfs  defaults,_netdev,x-systemd.automount  0  0
```

**Behavior:**

* Auto-mounts on access
* Survives reboot
* Network-aware

---

### 3. Samba (CIFS) Client Mount

**Mount Point:**

```bash
sudo mkdir -p /mnt/family
```

**fstab entry:**

```text
//thinkpad/Family /mnt/family cifs _netdev,username=arjun,uid=1000,gid=1000 0 0
```

**Result:**

* Works across both networks
* Authenticated access
* Suitable for GUI and non-root usage

---

### 4. Validation Commands (Executed)

```bash
ssh arjun@thinkpad uptime
df -h | grep homelab
mount | grep -E "nfs|cifs"
```

All returned expected output.

---

## Final State Summary (Day 4)

âœ… Server accessible **without internet**
âœ… Works across **multiple networks**
âœ… SMB for universal devices
âœ… NFS for Linux performance
âœ… Firewall hardened but permissive
âœ… Deterministic hostname resolution
âœ… Persistent mounts on client
âœ… Zero dependency on cloud services

---

## What This Setup Represents

* Personal NAS
* Offline-first home cloud
* Cross-platform file server
* Resume-grade systems project
* Foundation for:

  * Jellyfin
  * Backups
  * Remote access
  * Multi-user storage

---

## Deferred to Day 5+

* Headless optimization
* Power management tuning
* Display backlight minimization
* Kernel cleanup & LTS pinning
* Remote access from outside LAN (VPN)

---

**Status:**
ðŸŸ¢ **Day 4 complete. Infrastructure stable.**


